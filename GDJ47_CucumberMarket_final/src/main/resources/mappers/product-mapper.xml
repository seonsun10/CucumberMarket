<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="product">
	<resultMap type="product" id="productMap">
		<id column="pro_no" property="proNo"/>
		<result column="category_id" property="categoryName"/>
		<result column="title" property="title"/>
		<result column="pro_status" property="proStatus"/>
		<result column="price" property="price"/>
		<result column="pro_count" property="proCount"/>
		<result column="pro_content" property="proContent"/>
		<result column="enroll_date" property="enrollDate"/>
		<result column="region" property="region"/>
		<result column="solve_status" property="solveStatus"/>
		<result column="user_id" property="member.userId"/>
		<collection property="files" ofType="com.cu.cum.product.model.vo.Files" column="pro_no">
			<id column="files_no" property="filesNo"/>
			<result column="original_filename" property="originalFilename"/>
			<result column="rename_filename" property="renameFilename"/>
		</collection>
	</resultMap>
	<resultMap type="review" id="reviewMap">
		<id column="review_no" property="reviewNo"/>
		<result column="write_date" property="writeDate"/>
		<result column="ment" property="ment"/>
		<result column="host" property="host"/>
		<result column="oi" property="oi"/>
		<result column="writer" property="writer"/>
		<association property="product" javaType="product" column="proNo">
			<id column="pro_no" property="proNo"/>
		</association>
	</resultMap>

	<select id="selectProductCount" resultType="_int">
		SELECT COUNT(*) FROM PRODUCT WHERE USER_ID=#{userId}
	</select>
	
	<select id="selectProductList" resultMap="productMap">
		SELECT * FROM PRODUCT P LEFT JOIN FILES  F ON F.PRO_NO=P.PRO_NO 
			LEFT JOIN MEMBER M ON M.USERID=P.USER_ID WHERE P.USER_ID=#{userId}
	</select>
	
	<insert id="insertReview" parameterType="review">
		INSERT INTO REVIEW VALUES(#{proNo},#{oi},SYSDATE,#{writer})
	</insert>
	
	<select id="selectReviewCount" resultType="_int">
		SELECT COUNT(*) FROM REVIEW WHERE WRITER=#{userId}
	</select>
	
	<select id="selectReviewList" resultMap="reviewMap">
		SELECT * FROM REVIEW WHERE WRITER=#{userId}
	</select>
 	<select id="selectall" resultMap="productMap">
 	select * from product
	</select>
	<select id="selectproduct" resultMap="productMap" parameterType="_int">
	select * from product where pro_no=#{id}
	</select>
	<select id="selectWishList" parameterType="string" resultMap="productMap">
	select * from product where pro_no in (select pro_no from wish_list where user_id = #{userId})
	</select>
	<select id="selectWishCount" parameterType="string" resultType="_int">
	select count(*) from wish_list where user_id=#{id}
	</select>
</mapper>
